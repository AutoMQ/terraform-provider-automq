---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "automq_kafka_instance Resource - automq"
subcategory: ""
description: |-
  Using the automq_kafka_instance resource type, you can create and manage Kafka instances, where each instance represents a physical cluster.
  Note: This provider version is only compatible with AutoMQ control plane versions 8.0 and later.
---

# automq_kafka_instance (Resource)

![Preview](https://img.shields.io/badge/Lifecycle_Stage-Preview-blue?style=flat&logoColor=8A3BE2&labelColor=rgba)

Using the `automq_kafka_instance` resource type, you can create and manage Kafka instances, where each instance represents a physical cluster.

> **Note**: This provider version is only compatible with AutoMQ control plane versions 8.0 and later.

## Example Usage

```terraform
resource "automq_kafka_instance" "example" {
  environment_id = var.automq_environment_id
  name           = "automq-example"
  description    = "example deployment using inline compute specs"
  version        = "1.5.0"

  compute_specs = {
    reserved_aku = 6
    deploy_type  = "IAAS"

    networks = [
      {
        zone    = "us-east-1a"
        subnets = ["subnet-aaaaaa"]
      }
    ]

    data_buckets = [
      {
        bucket_name = "automq-data-bucket"
      }
    ]
  }

  features = {
    wal_mode = "EBSWAL"
    security = {
      authentication_methods   = ["sasl"]
      transit_encryption_modes = ["tls"]
    }

    metrics_exporter = {
      prometheus = {
        auth_type = "noauth"
        endpoint  = "http://prometheus.example.com/api/v1/write"
        labels = {
          "env" = "test"
        }
      }
    }

    table_topic = {
      warehouse     = "default"
      catalog_type  = "HIVE"
      metastore_uri = "thrift://hive-metastore.example.com:9083"
    }
  }
}

variable "automq_environment_id" {
  type = string
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `compute_specs` (Attributes) The compute specs of the instance (see [below for nested schema](#nestedatt--compute_specs))
- `environment_id` (String) Target AutoMQ BYOC environment, this attribute is specified during the deployment and installation process.
- `features` (Attributes) (see [below for nested schema](#nestedatt--features))
- `name` (String) The name of the Kafka instance. It can contain letters (a-z or A-Z), numbers (0-9), underscores (_), and hyphens (-), with a length limit of 3 to 64 characters.
- `version` (String) The software version of AutoMQ instance. If you need to specify a version, refer to the [documentation](https://docs.automq.com/automq-cloud/release-notes) to choose the appropriate version number.

### Optional

- `description` (String) The instance description are used to differentiate the purpose of the instance. They support letters (a-z or A-Z), numbers (0-9), underscores (_), spaces( ) and hyphens (-), with a length limit of 3 to 128 characters.
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))

### Read-Only

- `created_at` (String)
- `endpoints` (Attributes List) The bootstrap endpoints of instance. AutoMQ supports multiple access protocols; therefore, the Endpoint is a list. (see [below for nested schema](#nestedatt--endpoints))
- `id` (String) The ID of the Kafka instance.
- `last_updated` (String)
- `status` (String) The status of instance. Currently supports statuses: `Creating`, `Running`, `Deleting`, `Changing` and `Abnormal`. For definitions and limitations of each status, please refer to the [documentation](https://docs.automq.com/automq-cloud/using-automq-for-kafka/manage-instances#lifecycle).

<a id="nestedatt--compute_specs"></a>
### Nested Schema for `compute_specs`

Required:

- `networks` (Attributes List) To configure the network settings for an instance, you need to specify the availability zone(s) and subnet information. Currently, you can set either one availability zone or three availability zones. (see [below for nested schema](#nestedatt--compute_specs--networks))
- `reserved_aku` (Number) AutoMQ defines AKU (AutoMQ Kafka Unit) to measure the scale of the cluster. Each AKU provides 20 MiB/s of read/write throughput. For more details on AKU, please refer to the [documentation](https://docs.automq.com/automq-cloud/subscriptions-and-billings/byoc-env-billings/billing-instructions-for-byoc#indicator-constraints). The currently supported AKU specifications are 6, 8, 10, 12, 14, 16, 18, 20, 22, and 24. If an invalid AKU value is set, the instance cannot be created.

Optional:

- `data_buckets` (Attributes List) Inline bucket configuration replacing legacy bucket profiles. (see [below for nested schema](#nestedatt--compute_specs--data_buckets))
- `deploy_type` (String) Deployment platform for the instance. Supported values: `IAAS`, `K8S`.
- `dns_zone` (String) DNS zone used when creating custom records.
- `instance_role` (String)
- `kubernetes_cluster_id` (String) Identifier for the target Kubernetes cluster when deploy_type is KUBERNETES.
- `kubernetes_namespace` (String)
- `kubernetes_node_groups` (Attributes List) Node groups (or node pools) are units for unified configuration management of physical nodes in Kubernetes. Different Kubernetes providers may use different terms for node groups. Select target node groups that must be created in advance and configured for either single-AZ or three-AZ deployment. The instance node type must meet the requirements specified in the documentation. If you select a single-AZ node group, the AutoMQ instance will be deployed in a single availability zone; if you select a three-AZ node group, the instance will be deployed across three availability zones. (see [below for nested schema](#nestedatt--compute_specs--kubernetes_node_groups))
- `kubernetes_service_account` (String)

<a id="nestedatt--compute_specs--networks"></a>
### Nested Schema for `compute_specs.networks`

Required:

- `zone` (String) The availability zone ID of the cloud provider.

Optional:

- `subnets` (List of String) Specify the subnet under the corresponding availability zone for deploying the instance. Currently, only one subnet can be set for each availability zone.


<a id="nestedatt--compute_specs--data_buckets"></a>
### Nested Schema for `compute_specs.data_buckets`

Optional:

- `bucket_name` (String) Object storage bucket name used for data.


<a id="nestedatt--compute_specs--kubernetes_node_groups"></a>
### Nested Schema for `compute_specs.kubernetes_node_groups`

Required:

- `id` (String) Node group identifier



<a id="nestedatt--features"></a>
### Nested Schema for `features`

Required:

- `security` (Attributes) (see [below for nested schema](#nestedatt--features--security))
- `wal_mode` (String) Write-Ahead Logging mode: EBSWAL (using EBS as write buffer) or S3WAL (using object storage as write buffer). Defaults to EBSWAL.

Optional:

- `instance_configs` (Map of String) Additional configuration for the Kafka Instance. The currently supported parameters can be set by referring to the [documentation](https://docs.automq.com/automq-cloud/using-automq-for-kafka/restrictions#instance-level-configuration).
- `metrics_exporter` (Attributes) Configure Prometheus metrics scraping. (see [below for nested schema](#nestedatt--features--metrics_exporter))
- `table_topic` (Attributes) Inline table topic (Iceberg/Hive) configuration replacing legacy integration references. (see [below for nested schema](#nestedatt--features--table_topic))

<a id="nestedatt--features--security"></a>
### Nested Schema for `features.security`

Required:

- `authentication_methods` (Set of String) Configure client authentication methods. Supported values:

* `anonymous` - No authentication required. Only available in VPC networks
* `sasl` - SASL protocol authentication. Supports PLAIN and SCRAM mechanisms
* `mtls` - Mutual TLS authentication. Each client uses unique TLS certificates mapped to ACL identities. Automatically supported when TLS encryption is enabled

Changes to authentication methods require instance replacement.
- `transit_encryption_modes` (Set of String) Configure data transmission encryption. Supported values:

	* `plaintext` - No encryption. Only supported in VPC networks. Compatible with PLAINTEXT and SASL authentication protocols
	* `tls` - TLS encrypted transmission. Requires trusted CA certificates and server certificates

Changes to encryption modes require instance replacement.

Optional:

- `certificate_authority` (String) The trusted CA certificate chain in PEM format used by AutoMQ to verify the validity of both server and client certificates. Required when `mtls` authentication method is enabled.
- `certificate_chain` (String) The server certificate chain in PEM format issued by the CA. AutoMQ will deploy the instance with this certificate. Required when `mtls` authentication method is enabled.
- `data_encryption_mode` (String) The encryption mode used to protect data stored in AutoMQ using cloud provider's storage encryption capabilities. Supported values:

	* `NONE` - No encryption (default)
	* `CPMK` - Cloud Provider Managed Key encryption using cloud provider's KMS service

Changes to encryption mode require instance replacement.
- `private_key` (String) The private key in PEM format corresponding to the server certificate. AutoMQ will deploy the instance with this key. Required when `mtls` authentication method is enabled.
- `tls_hostname_validation_enabled` (Boolean) Enable TLS hostname validation when AutoMQ brokers terminate TLS. Defaults to true. Changing this setting requires recreating the instance.


<a id="nestedatt--features--metrics_exporter"></a>
### Nested Schema for `features.metrics_exporter`

Optional:

- `prometheus` (Attributes) (see [below for nested schema](#nestedatt--features--metrics_exporter--prometheus))

<a id="nestedatt--features--metrics_exporter--prometheus"></a>
### Nested Schema for `features.metrics_exporter.prometheus`

Required:

- `auth_type` (String)
- `endpoint` (String)

Optional:

- `labels` (Map of String)
- `password` (String)
- `prometheus_arn` (String)
- `token` (String)
- `username` (String)



<a id="nestedatt--features--table_topic"></a>
### Nested Schema for `features.table_topic`

Required:

- `catalog_type` (String)
- `warehouse` (String)

Optional:

- `hive_auth_mode` (String)
- `kerberos_principal` (String)
- `keytab_file` (String)
- `krb5conf_file` (String)
- `metastore_uri` (String)
- `user_principal` (String)



<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours).
- `delete` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours). Setting a timeout for a Delete operation is only applicable if changes are saved into state before the destroy operation occurs.


<a id="nestedatt--endpoints"></a>
### Nested Schema for `endpoints`

Read-Only:

- `bootstrap_servers` (String) The bootstrap servers of endpoint.
- `display_name` (String) The name of endpoint
- `mechanisms` (String) The supported mechanisms of endpoint. Currently support `PLAIN`, `SCRAM-SHA-256`, `SCRAM-SHA-512`.
- `network_type` (String) The network type of endpoint. Currently support `VPC` and `INTERNET`. `VPC` type is generally used for internal network access, while `INTERNET` type is used for accessing the AutoMQ cluster from the internet.
- `protocol` (String) The protocol of endpoint. Currently support `PLAINTEXT` and `SASL_PLAINTEXT`.
